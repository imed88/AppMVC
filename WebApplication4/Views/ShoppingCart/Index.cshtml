@using WebApplication4.Models;
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/adminlte/_mainLayout.cshtml";
}

<section class="content-header">
    <h1>
        Infirmerie
        <small>Nouvelle Ordonnance - Liste de produits selectionnes</small>
    </h1>
    <ol class="breadcrumb">
        <li><a href="#"><i class="fa fa-dashboard"></i> Accueil</a></li>
        <li>Nouvelle Ordonnance </li>
        <li class="active">Liste des produits</li>
    </ol>
</section>
<section class="content">
 
        @{
            if (Session["Cart"] != null)
            {

                using (Html.BeginForm("UpdateCart", "ShoppingCart", FormMethod.Post))
                {

                    {
                        List<WebApplication4.Models.Tables.ShopCart.Cart> temp = (List<WebApplication4.Models.Tables.ShopCart.Cart>)Session["Cart"];
                        var total = String.Format("{0}", temp.Sum(x => x.Quantity));

                        <div style="font-family:'Arial Rounded MT'; font-size:20px; padding-top:30px; padding-bottom:30px;">
                            TOTAL : @total |
                            @*@Html.ActionLink("Autre produit ", "ProductIndex", "Medicaments", new { @class = "btn btn-primary" })*@
                           
                            <input type="submit" value="Mise A jour" class="btn btn-primary" />
                            |
                            @Html.ActionLink("Liste Final", "CheckOut", "ShoppingCart", new { @class = "btn btn-primary" })

                        </div>

                    }
                    
                        <table class="table" border="1">
                            <tr>
                                <th></th>
                                <th>Nom du produit</th>
                                <th>Quantité</th>
                                <th></th>
                            </tr>
                            @foreach (var cart in (List<WebApplication4.Models.Tables.ShopCart.Cart>)Session["Cart"])
                            {
                                <tr>
                                    <td>
                                        <strong style="font-family:'Arial Rounded MT'; font-size:20px">@cart.Product.NameProduct</strong>


                                    </td>
                                    <td>
                                        @*@cart.Quantity*@
                                        <input type="text" name="quantity" id="quantity" value="@cart.Quantity" style="font-family:'Arial Rounded MT'; font-size:20px" />
                                        <span id="errmsg" style="color:red"></span>
                                    </td>
                                    @*<td>@(String.Format("{0}", cart.Quantity))</td>*@
                                    <td>
                                        @*@Html.ActionLink("Delete", "Delete", "ShoppingCart",
                    new { id = cart.Product.ProductID },
                    new { onclick = "return confirm ('Are you sure you want to delete this ?');" })*@
                                        <a href="@Url.Action("Delete", "ShoppingCart",new { id = @cart.Product.ProductID })" class="btn btn-danger">
                                            <i class="glyphicon glyphicon-trash"></i>
                                            <span>
                                                <strong></strong>
                                            </span>
                                        </a>
                                    </td>

                                </tr>

                            }


                        </table>
                   
                    <br />




                }
            }
            else
            {
                <h4>Pas de médicaments selectionnés !!</h4>
            }

        }
         
</section>

    <script>
        $(document).ready(function () {
            $("#quantity").keypress(function (e) {
                if (e.which != 8 && e.which != 0 && (e.which < 48 || e.which > 57)) {
                    $("#errmsg").html("Prière d'introduire des chiffres").show().fadeOut("slow")
                    return false;
                }
            });
        });
    </script>
